---
export interface Speaker {
  name: string;
  title?: string;
  bio: string;
  imageSrc?: string;
  imageAlt?: string;
}

interface Props {
  sectionTitle?: string;
  /** Optional intro paragraph below the section title. */
  intro?: string;
  /** Single speaker (legacy). */
  name?: string;
  title?: string;
  bio?: string;
  companyName?: string;
  companyUrl?: string;
  imageSrc?: string;
  imageAlt?: string;
  /** Multiple speakers. When set, name/title/bio are ignored. */
  speakers?: Speaker[];
}

const { sectionTitle = 'Speaker', intro, name, title, bio, companyName = 'VIA', companyUrl = 'https://www.wearevia.co', imageSrc, imageAlt, speakers } = Astro.props;

const list = speakers && speakers.length > 0
  ? speakers
  : name
    ? [{ name: name!, title, bio: bio!, imageSrc, imageAlt: imageAlt ?? name }]
    : [];
---

<section class="bg-white py-20 sm:py-28">
  <div class="mx-auto max-w-6xl px-6">
    <h2 class="text-2xl font-semibold tracking-tight text-via-black sm:text-3xl">
      {sectionTitle}
    </h2>
    {intro && (
      <p class="mt-4 max-w-3xl text-slate-600 leading-relaxed">
        {intro}
      </p>
    )}

    {list.length === 1 ? (
      <div class="mt-12 flex flex-col gap-12 sm:flex-row sm:items-start">
        <div class="shrink-0 sm:order-2">
          {list[0].imageSrc ? (
            <img
              src={list[0].imageSrc}
              alt={list[0].imageAlt ?? list[0].name}
              class="h-48 w-48 rounded-2xl object-cover shadow-lg grayscale sm:h-56 sm:w-56"
              width="224"
              height="224"
            />
          ) : (
            <div class="flex h-48 w-48 items-center justify-center rounded-2xl bg-via-light text-slate-400 sm:h-56 sm:w-56" aria-hidden="true">
              <span class="text-sm font-medium">Headshot</span>
            </div>
          )}
        </div>
        <div class="min-w-0 flex-1 sm:order-1">
          <h3 class="text-xl font-semibold text-via-black">{list[0].name}</h3>
          {list[0].title && <p class="mt-1 text-base text-via-gray">{list[0].title}</p>}
          <p class="mt-2">
            <a href={companyUrl} target="_blank" rel="noopener noreferrer" class="text-base font-medium text-via-black underline decoration-slate-300 underline-offset-2 hover:decoration-via-black">
              {companyName}
            </a>
          </p>
          <p class="mt-6 text-slate-600 leading-relaxed whitespace-pre-line">{list[0].bio}</p>
        </div>
      </div>
    ) : (
      <div class="mt-12 grid grid-cols-1 gap-16 lg:grid-cols-2">
        {list.map((speaker) => (
          <div class="flex flex-col gap-8 sm:flex-row sm:items-start">
            <div class="shrink-0">
              {speaker.imageSrc ? (
                <img
                  src={speaker.imageSrc}
                  alt={speaker.imageAlt ?? speaker.name}
                  class="h-40 w-40 rounded-2xl object-cover shadow-lg grayscale sm:h-48 sm:w-48"
                  width="192"
                  height="192"
                />
              ) : (
                <div class="flex h-40 w-40 items-center justify-center rounded-2xl bg-via-light text-slate-400 sm:h-48 sm:w-48" aria-hidden="true">
                  <span class="text-sm font-medium">Headshot</span>
                </div>
              )}
            </div>
            <div class="min-w-0 flex-1">
              <h3 class="text-xl font-semibold text-via-black">{speaker.name}</h3>
              {speaker.title && <p class="mt-1 text-base text-via-gray">{speaker.title}</p>}
              <p class="mt-2">
                <a href="https://www.wearevia.co" target="_blank" rel="noopener noreferrer" class="text-base font-medium text-via-black underline decoration-slate-300 underline-offset-2 hover:decoration-via-black">
                  VIA Co
                </a>
              </p>
              <p class="mt-6 text-slate-600 leading-relaxed whitespace-pre-line">{speaker.bio}</p>
            </div>
          </div>
        ))}
      </div>
    )}
  </div>
</section>

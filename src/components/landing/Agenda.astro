---
export interface AgendaItem {
  number: number;
  title: string;
  body?: string;
  /** For items with bullet points (e.g. Reset, 3F Framework, Emptying the Bottle). */
  bullets?: { label: string; text: string }[];
  /** Single path or array of paths; when array, icons are superimposed (layered). */
  iconPath: string | string[];
}

interface Props {
  sectionTitle: string;
  sectionIntro: string;
  items: AgendaItem[];
}

const { sectionTitle, sectionIntro, items } = Astro.props;
const base = import.meta.env.BASE_URL;

function iconPaths(item: AgendaItem): string[] {
  return Array.isArray(item.iconPath) ? item.iconPath : [item.iconPath];
}
---

<section class="py-24 bg-white">
  <div class="mx-auto max-w-6xl px-6">
    <div class="mx-auto max-w-3xl text-center mb-16">
      <h2 class="text-3xl font-bold tracking-tight text-via-black sm:text-4xl">
        {sectionTitle}
      </h2>
      <p class="mt-4 text-lg text-slate-600">
        {sectionIntro}
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-stretch">
      {items.map((item) => (
        <div class="bg-via-light rounded-2xl border border-slate-100 flex flex-col min-w-0 overflow-hidden group hover:shadow-lg transition-shadow duration-300">
          <div class="h-48 shrink-0 bg-via-black relative flex items-center justify-center p-8">
            <div class="absolute inset-0 flex items-center justify-center">
              <div class="relative w-32 h-32 sm:w-40 sm:h-40">
                {iconPaths(item).map((path) => (
                  <img
                    src={`${base}/${path}`}
                    alt=""
                    class="absolute inset-0 w-full h-full object-contain object-center opacity-90 group-hover:scale-105 transition-transform duration-500"
                  />
                ))}
              </div>
            </div>
            <div class="absolute top-4 left-4 w-10 h-10 bg-white/90 rounded-lg flex items-center justify-center text-via-black font-bold text-lg shadow-sm z-10">{item.number}</div>
          </div>
          <div class="p-8 flex-1 flex flex-col min-h-0">
            <h3 class="text-xl font-bold text-via-black mb-4 uppercase tracking-tight">{item.title}</h3>
            {item.body && (
              <p class="text-slate-600 leading-relaxed text-sm" set:html={item.body}></p>
            )}
            {item.bullets && item.bullets.length > 0 && (
              <div class="text-slate-600 leading-relaxed text-sm space-y-2">
                {item.bullets.map((b) => (
                  <p><strong>{b.label}:</strong> {b.text}</p>
                ))}
              </div>
            )}
          </div>
        </div>
      ))}
    </div>
  </div>
</section>
